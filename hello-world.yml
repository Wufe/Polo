applications:
  - name: hello-world
    remote: "https://github.com/nginxinc/NGINX-Demos"
    target: "http://127.0.0.1:{{port}}"
    host: "test.archiproducts.com"
    use_git_cli: true
    commands:
      start:
        - command: echo "command 1"
        # - command: 'docker run -p {{port}}:80 -d nginxdemos/hello | xargs -I % echo "polo[container_id=%]"'
        - command: echo "command 3"
        - command: sleep 1
        - command: echo "slept 1s"
        - command: sleep 2
        - command: echo "slept 2s"
        - command: sleep 3
        - command: echo "slept 3s"
        - command: sleep 4
        - command: echo "slept 4s"
        - command: sleep 5
        - command: echo "slept 5s"
        - command: sleep 6
        - command: echo "slept 6s"
        - command: sleep 7
        - command: echo "slept 7s"
        - command: sleep 8
        - command: echo "slept 8s"
        - command: sleep 9
        - command: echo "slept 9s"
        - command: 'docker run -p {{port}}:80 -d nginxdemos/hello'
          output_variable: 'container_id'
      stop:
        - command: "docker kill {{container_id}}"
    recycle:
      inactivity_timeout: 30
    healthcheck:
      retry_interval: 5

  # - name: hello-world-long-starttime
  #   remote: "https://github.com/nginxinc/NGINX-Demos"
  #   target: "http://127.0.0.1:{{port}}"
  #   commands:
  #     start:
  #       - command: pwd
  #       - command: pwd
  #         working_dir: ./autoscaling-demo
  #       - command: pwd
  #     stop:
  #       - command: ''
  #   recycle:
  #     inactivity_timeout: 600
  #   healthcheck:
  #     retry_interval: 60
  #     retry_timeout: 3600