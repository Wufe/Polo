services:
  - name: hello-world
    remote: "https://github.com/nginxinc/NGINX-Demos"
    target: "http://127.0.0.1:{{port}}"
    commands:
      start:
        # - command: 'docker run -p {{port}}:80 -d nginxdemos/hello | xargs -I % echo "polo[container_id=%]"'
        - command: 'docker run -p {{port}}:80 -d nginxdemos/hello'
          output_variable: 'container_id'
      stop:
        - command: "docker kill {{container_id}}"
    recycle:
      inactivity_timeout: 3000
    healthcheck:
      retry_interval: 5
  - name: hello-world-short-lifespan
    remote: "https://github.com/nginxinc/NGINX-Demos"
    target: "http://127.0.0.1:{{port}}"
    commands:
      start:
        # - command: 'docker run -p {{port}}:80 -d nginxdemos/hello | xargs -I % echo "polo[container_id=%]"'
        - command: 'docker run -p {{port}}:80 -d nginxdemos/hello'
          output_variable: 'container_id'
      stop:
        - command: "docker kill {{container_id}}"
    recycle:
      inactivity_timeout: 20
    healthcheck:
      retry_interval: 5
  - name: hello-world-long-starttime
    remote: "https://github.com/nginxinc/NGINX-Demos"
    target: "http://127.0.0.1:{{port}}"
    commands:
      start:
        - command: sleep 10
      stop:
        - command: ''
    recycle:
      inactivity_timeout: 600
    healthcheck:
      retry_interval: 60
      retry_timeout: 3600